<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AudioQalb গিভওয়ে ফর্ম | ৫০টি প্রশ্ন</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: radial-gradient(circle at 50% 50%, #0b0e14, #030405); font-family: 'Cairo', 'Inter', sans-serif; color: white; min-height: 100vh; padding: 20px; }
    .container { max-width: 1000px; margin: 0 auto; background: rgba(8,12,25,0.85); backdrop-filter: blur(20px); border: 2px solid rgba(255,215,0,0.35); border-radius: 40px; padding: 30px; box-shadow: 0 30px 60px rgba(0,0,0,0.7); }
    h1 { font-size: 48px; color: #ffd700; text-align: center; margin-bottom: 10px; }
    .notice { background: #cc0000; border: 2px solid #ffd700; border-radius: 60px; padding: 15px; margin: 20px 0; text-align: center; font-size: 24px; }
    .notice i { color: #ffd700; margin-right: 10px; }
    marquee { font-size: 20px; background: rgba(255,215,0,0.2); padding: 10px; border-radius: 40px; margin-bottom: 20px; }
    .form-group { margin-bottom: 20px; }
    label { display: block; font-size: 24px; margin-bottom: 5px; color: #ffd700; }
    input, select { width: 100%; padding: 15px; font-size: 20px; border-radius: 30px; border: 2px solid #ffd700; background: rgba(0,0,0,0.5); color: white; font-family: 'Inter', sans-serif; }
    input:focus, select:focus { outline: none; border-color: #ffaa00; }
    .quiz-question { background: rgba(255,215,0,0.1); border: 1px solid #ffd700; border-radius: 30px; padding: 20px; margin-bottom: 15px; }
    .quiz-question p { font-size: 24px; margin-bottom: 10px; }
    .options { display: flex; gap: 20px; flex-wrap: wrap; }
    .options label { display: flex; align-items: center; gap: 5px; font-size: 20px; color: white; cursor: pointer; }
    .options input[type="radio"] { width: auto; margin-right: 5px; accent-color: #ffd700; }
    .submit-btn { background: #ff0000; border: 2px solid #ffd700; color: white; font-size: 36px; font-weight: 900; padding: 20px 40px; border-radius: 60px; cursor: pointer; width: 100%; transition: transform 0.3s; margin-top: 20px; }
    .submit-btn:hover { transform: scale(1.05); background: #cc0000; }
    .footer { text-align: center; margin-top: 20px; color: rgba(255,215,0,0.8); }
  </style>
</head>
<body>
  <div class="container">
    <h1><i class="fas fa-gift"></i> AudioQalb গিভওয়ে ফর্ম</h1>
    
    <!-- নোটিশ মার্কি -->
    <div class="notice">
      <i class="fas fa-bullhorn"></i> বিজ্ঞপ্তি
    </div>
    <marquee behavior="scroll" direction="left" scrollamount="5">
      <i class="fas fa-trophy"></i> বিজয়ীদের নাম আমাদের চ্যানেলে পোস্ট করে জানিয়ে দেওয়া হবে। <i class="fas fa-trophy"></i> একবারই ফর্ম সাবমিট করা যাবে। সময় শেষ রাত ৯টা।
    </marquee>

    <form id="entryForm">
      <!-- ব্যক্তিগত তথ্য -->
      <div class="form-group">
        <label><i class="fas fa-user"></i> আপনার নাম</label>
        <input type="text" id="fullName" placeholder="আপনার পূর্ণ নাম" required>
      </div>
      <div class="form-group">
        <label><i class="fas fa-map-marker-alt"></i> ঠিকানা</label>
        <input type="text" id="address" placeholder="আপনার ঠিকানা" required>
      </div>
      <div class="form-group">
        <label><i class="fas fa-phone-alt"></i> মোবাইল নম্বর</label>
        <input type="tel" id="mobile" placeholder="০১XXXXXXXXX" required>
      </div>

      <!-- কুইজ প্রশ্নগুলো ডায়নামিকভাবে লোড হবে -->
      <div id="questionsContainer"></div>

      <button type="submit" class="submit-btn"><i class="fas fa-paper-plane"></i> সাবমিট</button>
    </form>

    <div class="footer">
      <i class="fas fa-star"></i> শুধুমাত্র একবার সাবমিট করুন
    </div>
  </div>

  <script>
    // আপনার Apps Script URL (একই)
    const API_URL = "https://script.google.com/macros/s/AKfycbzOuyVqqahjf02keFaTgA-7O4lCfNZYnbFTs98VfLy_r-Qd5HwX-pZ5cXRsgyEy1NNWIQ/exec";

    let quizQuestions = [];

    // ফর্ম লোড হওয়ার সাথে সাথে কুইজ প্রশ্ন লোড করুন
    async function loadQuestions() {
      try {
        const res = await fetch(API_URL + '?t=' + new Date().getTime());
        if (!res.ok) throw new Error('Network error');
        const data = await res.json();
        // শুধু প্রশ্নগুলো নিন (day নির্বিশেষে সব, অথবা আপনার পছন্দমত)
        quizQuestions = data.slice(0, 50); // প্রথম ৫০টি প্রশ্ন নিন
        renderQuestions();
      } catch (error) {
        console.error(error);
        document.getElementById('questionsContainer').innerHTML = '<p style="color:red;">প্রশ্ন লোড করতে ব্যর্থ। পরে আবার চেষ্টা করুন।</p>';
      }
    }

    function renderQuestions() {
      const container = document.getElementById('questionsContainer');
      container.innerHTML = '';
      quizQuestions.forEach((q, index) => {
        const qDiv = document.createElement('div');
        qDiv.className = 'quiz-question';
        qDiv.innerHTML = `
          <p><strong>প্রশ্ন ${index+1}:</strong> ${q.question} <br><small style="color:#ffd700;">${q.questionEN || ''}</small></p>
          <div class="options">
            <label><input type="radio" name="q${index}" value="A" required> A) ${q.optionA} <small style="color:#ffd700;">${q.optionAEN || ''}</small></label>
            <label><input type="radio" name="q${index}" value="B" required> B) ${q.optionB} <small style="color:#ffd700;">${q.optionBEN || ''}</small></label>
            <label><input type="radio" name="q${index}" value="C" required> C) ${q.optionC} <small style="color:#ffd700;">${q.optionCEN || ''}</small></label>
          </div>
        `;
        container.appendChild(qDiv);
      });
    }

    // ফর্ম সাবমিট ইভেন্ট
    document.getElementById('entryForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      // ব্যক্তিগত তথ্য
      const name = document.getElementById('fullName').value;
      const address = document.getElementById('address').value;
      const mobile = document.getElementById('mobile').value;

      // উত্তর সংগ্রহ
      const answers = [];
      for (let i = 0; i < quizQuestions.length; i++) {
        const radios = document.getElementsByName(`q${i}`);
        let selected = null;
        for (const radio of radios) {
          if (radio.checked) {
            selected = radio.value;
            break;
          }
        }
        answers.push(selected || '');
      }

      // ক্লায়েন্ট-সাইডে স্কোর গণনা (ঐচ্ছিক, তবে ব্যাকএন্ডে নির্ভরযোগ্য গণনা হবে)
      // আমরা পুরো ডেটা ব্যাকএন্ডে পাঠাব, সেখানেই স্কোর হবে

      // ডেটা প্যাকেজ
      const payload = {
        action: 'submitEntry',
        name: name,
        address: address,
        mobile: mobile,
        answers: answers,
        timestamp: new Date().toISOString()
      };

      try {
        const response = await fetch(API_URL, {
          method: 'POST',
          mode: 'no-cors', // CORS এড়াতে no-cors ব্যবহার করা হচ্ছে (তবে response পাওয়া যাবে না)
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        // no-cors মোডে response এর status পাওয়া যায় না, তাই আমরা ধরে নিই সফল
        alert('আপনার তথ্য সফলভাবে জমা হয়েছে! অংশগ্রহণের জন্য ধন্যবাদ।');
        // ফর্ম রিসেট বা অন্য কিছু
        document.getElementById('entryForm').reset();
        // প্রশ্নপত্র পুনরায় লোড করলে রেডিও রিসেট হবে
        loadQuestions(); 

      } catch (error) {
        console.error('Submission error:', error);
        alert('সাবমিট করতে সমস্যা হয়েছে। আবার চেষ্টা করুন।');
      }
    });

    // শুরুতে প্রশ্ন লোড করুন
    loadQuestions();
  </script>
</body>
</html>
